<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Search</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header Component -->
    <header class="bg-white shadow-md p-4 sticky top-0 z-50">
        <nav class="flex items-center justify-between container mx-auto px-4">
            <a href="#" class="text-2xl font-bold text-gray-800" onclick="showPage('homepage')">
                <span class="text-blue-600">Medi</span>Find
            </a>
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Home</a>
                <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">About</a>
                <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Contact</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-gray-600 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white p-4 mt-2 rounded-lg shadow-lg">
            <a href="#" class="block py-2 text-gray-600 hover:text-blue-600" onclick="showPage('homepage')">Home</a>
            <a href="#" class="block py-2 text-gray-600 hover:text-blue-600">About</a>
            <a href="#" class="block py-2 text-gray-600 hover:text-blue-600">Contact</a>
        </div>
    </header>

    <main class="flex-grow">
        <!-- Homepage -->
        <section id="homepage" class="page active">
            <div class="container mx-auto px-4 py-16 flex flex-col items-center justify-center min-h-[calc(100vh-160px)]">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 text-center leading-tight mb-4">
                    Find the Right Doctor, <span class="text-blue-600">Easily</span>.
                </h1>
                <p class="text-lg text-gray-600 text-center mb-8 max-w-2xl">
                    Search for doctors by specialization, location, or name. Your health, your choice.
                </p>
                <form id="search-form" class="w-full max-w-3xl bg-white p-6 rounded-3xl shadow-xl flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4">
                    <input type="text" id="specialization" placeholder="Specialization (e.g., Cardiology)" class="flex-grow w-full md:w-auto p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                    <input type="text" id="location" placeholder="Location (e.g., New York)" class="flex-grow w-full md:w-auto p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                    <button type="submit" class="w-full md:w-auto px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-colors duration-300 shadow-lg">
                        Search Doctors
                    </button>
                </form>
            </div>
        </section>

        <!-- Search Results Page -->
        <section id="results-page" class="page hidden">
            <div class="container mx-auto px-4 py-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Search Results</h2>
                <div id="results-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Doctor cards will be dynamically inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Doctor Profile Page -->
        <section id="profile-page" class="page hidden">
            <div class="container mx-auto px-4 py-8">
                <div id="profile-container" class="bg-white p-8 rounded-3xl shadow-xl">
                    <!-- Doctor profile content will be dynamically inserted here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer Component -->
    <footer class="bg-gray-800 text-gray-300 py-8 mt-auto">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2024 MediFind. All rights reserved.</p>
            <div class="flex items-center justify-center space-x-4 mt-4">
                <a href="#" class="hover:text-white transition-colors duration-300">Privacy Policy</a>
                <a href="#" class="hover:text-white transition-colors duration-300">Terms of Service</a>
                <a href="#" class="hover:text-white transition-colors duration-300">FAQ</a>
            </div>
            <div class="flex items-center justify-center space-x-4 mt-4">
                <!-- Social media icons - using SVG for a clean look -->
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07c3.25.15 4.707 1.607 4.85 4.85.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.15 3.243-1.607 4.707-4.85 4.85-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-3.243-.15-4.707-1.607-4.85-4.85-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.15-3.25 1.607-4.707 4.85-4.85 1.266-.058 1.646-.07 4.85-.07zm0-2.163c-3.286 0-3.682.013-4.992.073-4.723.21-7.279 2.766-7.489 7.489-.06 1.31-.073 1.706-.073 4.992s.013 3.682.073 4.992c.21 4.723 2.766 7.279 7.489 7.489 1.31.06 1.706.073 4.992.073s3.682-.013 4.992-.073c4.723-.21 7.279-2.766 7.489-7.489.06-1.31.073-1.706.073-4.992s-.013-3.682-.073-4.992c-.21-4.723-2.766-7.279-7.489-7.489-1.31-.06-1.706-.073-4.992-.073zM12 5.839c3.403 0 6.161 2.758 6.161 6.161s-2.758 6.161-6.161 6.161-6.161-2.758-6.161-6.161 2.758-6.161 6.161-6.161zm0-2.161c-4.633 0-8.39 3.757-8.39 8.39s3.757 8.39 8.39 8.39 8.39-3.757 8.39-8.39-3.757-8.39-8.39-8.39zm6.653-2.4c.82 0 1.485.665 1.485 1.485s-.665 1.485-1.485 1.485-1.485-.665-1.485-1.485.665-1.485 1.485-1.485z"></path>
                    </svg>
                </a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22.254 6.36c-.63.957-1.42 1.758-2.348 2.378.898-.537 1.587-1.503 1.914-2.597-.84.498-1.77.85-2.762 1.04-.8-.85-1.93-1.378-3.193-1.378-2.41 0-4.366 1.956-4.366 4.366 0 .343.04.676.118 1.002-3.626-.183-6.84-1.916-9.04-4.55-.376.643-.594 1.393-.594 2.193 0 1.51.768 2.843 1.94 3.622-.72-.023-1.398-.22-1.99-.548v.054c0 2.115 1.506 3.882 3.492 4.298-.36.096-.74.148-1.13.148-.276 0-.544-.028-.802-.078.556 1.733 2.168 2.99 4.07 3.024-1.496 1.174-3.38.188-4.57-1.127a1.688 1.688 0 01-.118-.17c1.942 1.246 4.254 1.97 6.696 1.97 8.034 0 12.42-6.657 12.42-12.42 0-.19-.004-.38-.01-.57.854-.616 1.594-1.38 2.18-2.25z"></path>
                    </svg>
                </a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-2 16h-2v-6h2v6zm-2-7c-.552 0-1-.448-1-1s.448-1 1-1 1 .448 1 1-.448 1-1 1zm8 7h-2v-3c0-.552-.448-1-1-1s-1 .448-1 1v3h-2v-6h2v.965c.478-.645 1.258-1.465 2-1.465 1.104 0 2 .896 2 2v5z"></path>
                    </svg>
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Get elements
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const searchForm = document.getElementById('search-form');
        const resultsContainer = document.getElementById('results-container');
        const profileContainer = document.getElementById('profile-container');
        const pages = document.querySelectorAll('.page');

        // Function to show a specific page
        function showPage(pageId) {
            pages.forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('active');
            });
            const currentPage = document.getElementById(pageId);
            currentPage.classList.remove('hidden');
            currentPage.classList.add('active');
        }

        // Toggle mobile menu
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Handle search form submission
        searchForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const specialization = document.getElementById('specialization').value;
            const location = document.getElementById('location').value;

            // Fetch data from your backend API
            const apiUrl = `api.php?specialization=${specialization}&location=${location}`;

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const doctors = await response.json();
                renderResults(doctors);
                showPage('results-page');
            } catch (error) {
                console.error('There was a problem with the fetch operation:', error);
                resultsContainer.innerHTML = '<p class="text-center text-red-500 text-lg col-span-full">An error occurred while fetching data. Please try again.</p>';
                showPage('results-page');
            }
        });

        // Function to render search results
        function renderResults(doctors) {
            resultsContainer.innerHTML = '';
            if (doctors.length === 0) {
                resultsContainer.innerHTML = '<p class="text-center text-gray-500 text-lg col-span-full">No doctors found for your search criteria. Please try again.</p>';
                return;
            }

            doctors.forEach(doctor => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-3xl shadow-lg p-6 flex flex-col items-center text-center transition-transform transform hover:scale-105 duration-300 cursor-pointer';
                card.innerHTML = `
                    <img src="${doctor.image_url}" alt="${doctor.name}" class="w-32 h-32 rounded-full object-cover mb-4 ring-4 ring-blue-500 ring-opacity-50">
                    <h3 class="text-xl font-semibold text-gray-800">${doctor.name}</h3>
                    <p class="text-blue-600 font-medium">${doctor.specialization}</p>
                    <p class="text-gray-500 text-sm mt-1">${doctor.location}</p>
                `;
                card.addEventListener('click', () => {
                    renderProfile(doctor);
                    showPage('profile-page');
                });
                resultsContainer.appendChild(card);
            });
        }

        // Function to render a doctor's profile page
        function renderProfile(doctor) {
            // Because the database stores `qualifications` as a single string, we split it into an array
            const qualificationsArray = doctor.qualifications ? doctor.qualifications.split(',') : [];

            profileContainer.innerHTML = `
                <button onclick="showPage('results-page')" class="flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-300 mb-6 font-medium">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    Back to results
                </button>
                <div class="flex flex-col md:flex-row items-center md:items-start space-y-6 md:space-y-0 md:space-x-8">
                    <img src="${doctor.image_url}" alt="${doctor.name}" class="w-48 h-48 rounded-full object-cover ring-4 ring-blue-500 ring-opacity-50 shadow-lg">
                    <div class="text-center md:text-left">
                        <h2 class="text-3xl font-bold text-gray-800">${doctor.name}</h2>
                        <p class="text-blue-600 text-xl font-medium mt-1">${doctor.specialization}</p>
                        <p class="text-gray-500 mt-2">${doctor.location}</p>
                        <div class="mt-4">
                            <span class="font-semibold text-gray-700">Qualifications:</span> ${qualificationsArray.join(', ')}
                        </div>
                        <div class="mt-2">
                            <span class="font-semibold text-gray-700">Contact:</span> ${doctor.contact}
                        </div>
                    </div>
                </div>
                <div class="mt-8">
                    <h3 class="text-2xl font-semibold text-gray-800">About Dr. ${doctor.name.split(' ')[2]}</h3>
                    <p class="text-gray-600 mt-2 leading-relaxed">${doctor.bio}</p>
                </div>
                <div class="mt-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">Clinic Location</h3>
                    <div class="rounded-xl overflow-hidden shadow-md" style="height: 400px;">
                        <iframe
                            src="${doctor.clinic_map}"
                            width="100%"
                            height="100%"
                            style="border:0;"
                            allowfullscreen=""
                            loading="lazy"
                        ></iframe>
                    </div>
                </div>
            `;
        }

        // Initially show the homepage
        document.addEventListener('DOMContentLoaded', () => {
            showPage('homepage');
        });
    </script>
</body>
</html>
